# 13장 검색어 자동완성 시스템

자동 완성 : 입력 중인 글자에 맞는 검색어가 자동으로 완성되어서 표시되는 기능

- 요구사항

  자동완성될 검색어의 첫부분이냐, 중간 부분이냐 → 첫부분으로 한정

  몇 개의 자동완성 검색어가 표시 → 5개

  검색어 5개를 고르는 기준 → 질의 빈도 기반 검색어 인기 순위

  맞춤법 검사, 자동수정 지원 여부 → 지원하지 않음

  질의 언어 → 영어, 다만, 다국어 지원을 생각해도 됨

  대문자나 특수 문자 처리 여부 → 소문자로만

  얼마나 많은 사용자 → DAU 기준 천만명

- 개략적 설계안
  - 데이터 수집 서비스
    - 사용자가 입력한 질의를 실시간으로 수집하는 시스템
    - 질의문과 사용빈도를 저장하는 빈도 테이블 활용
  - 질의 서비스
    - 주어진 질의에 다섯 개의 인기 검색어를 정렬하는 서비스
- 상세 설계
  - 트라이(trie) 자료구조
    - 문자열들을 간략하게 저장할 수 있는 자료구조
  - 데이터 수집 서비스
    - 용례에 따라 서비스를 설계
  - 질의 서비스
    - 검색창에 입력된 질의에 관한 원본 데이터가 보관
  - 규모 확장이 가능한 저장소
  - 트라이 연산
    - 트라이 생성
      - 작업 서버가 담당하며, 로그나 데이터베이스로부터 취합된 데이터를 이용하여 트라이를 생성한다.
    - 트라이 갱신
      - 매주 한 번 갱신하는 방법→ 새로운 트라이를 만든 다음 기존 트라이를 대체한다.
      - 트라이의 각 노드를 개별적으로 갱신하는 방법→ 트라이가 작을때는 고려해봄직한 방안.
    - 검색어 삭제
      - 트라이 캐시 앞에 필터 계층을 두고 부적절한 질의어가 반환되지 않도록 할 수 있다


# 14장 유튜브 설계

- 문제 이해 및 설계 범위 확정
  - 주요 기능: 비디오 업로드 및 시청
  - 클라이언트: 모바일 앱, 웹 브라우저, 스마트 TV
  - DAU: 500만명
  - 평균 사용시간: 하루 30분
  - 다국어 지원
  - 다양한 비디오 해상도 및 포맷 지원
  - 비디오 데이터는 암호화 필요
  - 비디오 최대 크기: 1GB
  - 클라우드 서비스 활용 가능

  설계할 시스템의 기능:

  - 빠른 비디오 업로드
  - 원활한 비디오 재생
  - 재생 품질 선택 가능
  - 낮은 인프라 비용
  - 고가용성, 규모 확장성, 안정성
  - 모바일 앱, 웹 브라우저, 스마트 TV
- 개략적 설계안 제시 및 동의 구하기
  - 클라이언트: 컴퓨터, 스마트폰, 스마트TV 등 다양한 디바이스
  - CDN: 비디오 재생 요청 시 가까운 CDN 서버에서 데이터 제공
  - API 서버: 로그인, 피드 추천, 업로드 URL 생성, 메타데이터 저장/갱신 등 비디오 스트리밍을 제외한 모든 요청 처리
- 상세 설계

  ### **비디오 트랜스코딩**

  비디오 트랜스코딩이 중요한 이유:

  - 대용량 저장 공간 절약: 원본 고화질 비디오는 매우 큰 저장공간을 차지
  - 다양한 디바이스 호환성: 다양한 기기/브라우저는 특정 포맷만 지원
  - 네트워크 대역폭 최적화: 사용자의 네트워크 속도에 따라 고화질 또는 저화질 버전을 스트리밍
  - 모바일 환경 대응: 네트워크 상태가 불안정할 때 원활한 비디오 재생을 위해 화질 자동 전환 필요

  트랜스코딩 구성 요소:

  - 컨테이너: 비디오, 오디오, 메타데이터를 묶는 포맷 (.avi, .mov, .mp4 등)
  - 코덱: 비디오 압축 및 압축 해제 알고리즘 (주요 코덱: H.264, VP9, HEVC)

  ### **유향 비순환 그래프(DAG)모델**

  - 문제: 트랜스코딩은 연산량이 많고 복잡하므로 유연성과 병렬성이 필요
  - 해결책: 작업(Task)을 여러 단계로 나누어 순차/병렬로 실행 가능한 DAG 모델 도입